<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Login - Cooking Game</title>
  <link rel="stylesheet" href="/static/styles.css" />
</head>


<body>
<div id="header"></div>

  <div class="login-container">
    <h1>Log in or Sign Up </h1>
    <p>Enter your email and password to sign in or create a new account.</p>

    <form id="authForm">
      <label for="email">Email:</label><br />
      <input type="email" id="email" name="email" required /><br />

      <label for="password">Password:</label><br />
      <input type="password" id="password" name="password" required /><br />

      <button type="submit">Continue</button>
    </form>
<br>
or
<br>
<a href="/register-page">Create an account</a>

<br>

    <div id="authMessage" style="margin-top: 1rem; color: red;"></div>
  </div>
<br>
<br>
<br>
<H2> How the Game Works </H2>
<br>
<p>
Welcome to the AI-Powered Cooking Simulator!
In this text-based cooking game, you begin your journey as the owner of a small street-side food stand. Your goal? Work your way up to owning larger and better restaurants!
Each day starts at the Cooking Emporium—a massive store where you can buy all the ingredients and supplies you’ll need. After shopping, return to your food stand and start cooking.
You'll prepare four meals per day: breakfast, lunch, dinner, and dessert. How well you cook each meal determines how much money you earn. Use your earnings to buy better ingredients, upgrade your equipment, and eventually move into bigger and more advanced cooking establishments.
You play by simply typing your actions. The AI reads what you write and responds based on the game’s built-in rules. Talk to it like you would a real person: ask questions, explain what you want to do, and describe how you're cooking. The more detailed and skillful your cooking descriptions are, the better your results will be!
Think you’ve got what it takes to be a top chef?
Let’s get cooking!
</p>
  <script>
  
    // Insert Header
  fetch('/static/header.html')
    .then(res => res.text())
    .then(data => {
      document.getElementById('header').innerHTML = data;
    });

  // Insert Footer
  fetch('/static/footer.html')
    .then(res => res.text())
    .then(data => {
      document.getElementById('footer').innerHTML = data;
    });  
    const form = document.getElementById("authForm");
    const msg = document.getElementById("authMessage");

    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      const email = document.getElementById("email").value;
      const password = document.getElementById("password").value;

      // Try login first
      let response = await fetch("/login", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ email, password })
      });

      let result = await response.json();

      if (response.ok) {
        localStorage.setItem("user_id", result.user_id);
        window.location.href = "/game";
      } else if (result.error === "Invalid credentials") {
        // Register fallback
        response = await fetch("/register", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ email, password })
        });
        result = await response.json();
        if (response.ok) {
          localStorage.setItem("user_id", result.user_id);
          window.location.href = "/game";
        } else {
          msg.innerText = "Signup failed: " + result.error;
        }
      } else {
        msg.innerText = result.error;
      }
    });
  </script>
<div id="footer"></div>
</body>
</html>
